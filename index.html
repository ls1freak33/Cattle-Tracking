<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cattle Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#f2f2f2;--card:#fff;
  --primary:#2e7d32;--secondary:#0277bd;--danger:#c62828;
}
body{margin:0;padding:15px;font-family:Arial;background:var(--bg)}
h1{text-align:center}
button{width:100%;padding:14px;margin:6px 0;font-size:16px;border-radius:10px;border:none;color:#fff}
.primary{background:var(--primary)}
.secondary{background:var(--secondary)}
.danger{background:var(--danger)}
.small{width:70%;margin:8px auto}
input,select{width:100%;padding:12px;margin:6px 0;border-radius:8px;border:1px solid #ccc}
.card{background:var(--card);padding:15px;border-radius:12px;margin-top:12px}
.list{cursor:pointer}
.hidden{display:none}
.badge{background:#e8f5e9;padding:6px;border-radius:6px;margin:4px 0}
</style>
</head>

<body>

<h1>ğŸ„ Cattle Tracker</h1>

<div id="screens">

<!-- HOME -->
<div id="home">
  <button class="primary" onclick="show('calves')">Calves</button>
  <button class="secondary" onclick="show('heifers')">Heifers</button>
  <button class="secondary" onclick="show('cows')">Cows</button>
  <button class="secondary" onclick="show('bulls')">Bulls</button>
</div>

<!-- LIST SCREENS -->
<div id="calves" class="hidden"><div id="calfList"></div><button class="secondary" onclick="show('home')">Back</button></div>
<div id="heifers" class="hidden"><div id="heiferList"></div><button class="secondary" onclick="show('home')">Back</button></div>
<div id="cows" class="hidden"><button class="primary" onclick="show('addCow')">â• Add Cow</button><div id="cowList"></div><button class="secondary" onclick="show('home')">Back</button></div>
<div id="bulls" class="hidden"><button class="primary" onclick="show('addBull')">â• Add Bull</button><div id="bullList"></div><button class="secondary" onclick="show('home')">Back</button></div>

<!-- ADD CALF -->
<div id="addCalf" class="card hidden">
  <h2>Add Calf</h2>
  <select id="sex"><option>Female</option><option>Male</option></select>
  <input type="date" id="birth">
  <select id="dam"></select>
  <select id="sire"></select>
  <select id="status"><option>Kept</option><option>Sold</option></select>
  <button class="primary" onclick="saveCalf()">Save</button>
  <button class="secondary" onclick="show('calves')">Cancel</button>
</div>

<!-- ADD COW -->
<div id="addCow" class="card hidden">
  <h2>Add Existing Cow</h2>
  <input id="tag" placeholder="Tag (optional)">
  <input type="date" id="cowBirth">
  <select id="color"><option>Yellow</option><option>Red</option><option>Orange</option><option>White</option></select>
  <button class="primary" onclick="saveCow()">Save</button>
  <button class="secondary" onclick="show('cows')">Cancel</button>
</div>

<!-- ADD BULL -->
<div id="addBull" class="card hidden">
  <h2>Add Bull</h2>
  <input id="bullNum" placeholder="Bull Number">
  <button class="primary" onclick="saveBull()">Save</button>
  <button class="secondary" onclick="show('bulls')">Cancel</button>
</div>

<div id="detail" class="card hidden"></div>

</div>

<script>
let animals = JSON.parse(localStorage.animals || "[]");
let bulls = JSON.parse(localStorage.bulls || "[]");
let current = null;

const saveAll = () => {
  localStorage.animals = JSON.stringify(animals);
  localStorage.bulls = JSON.stringify(bulls);
};

const show = id => {
  document.querySelectorAll("#screens>div").forEach(d=>d.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  refresh();
};

const refresh = () => {
  calfList.innerHTML = animals.filter(a=>a.role==="calf").map(a=>card(a)).join("");
  heiferList.innerHTML = animals.filter(a=>a.role==="heifer").map(a=>card(a)).join("");
  cowList.innerHTML = animals.filter(a=>a.role==="cow").map(a=>card(a)).join("");
  bullList.innerHTML = bulls.map(b=>`<div class="card list" onclick="openBull('${b}')">ğŸ‚ Bull ${b}</div>`).join("");

  dam.innerHTML = animals.filter(a=>a.role==="cow").map(a=>`<option>${a.tag||"Untitled Cow"}</option>`).join("");
  sire.innerHTML = bulls.map(b=>`<option>${b}</option>`).join("");
};

const card = a => `
<div class="card list" onclick="openAnimal(${a.id})">
  ${a.role.toUpperCase()} | ${a.tag||"No Tag"} | ${a.status||""}
</div>`;

const saveCalf = () => {
  animals.push({
    id:Date.now(), role:"calf",
    sex:sex.value, birth:birth.value,
    dam:dam.value, sire:sire.value,
    status:status.value,
    tag:"", color:"", vaccines:[]
  });
  saveAll(); show("calves");
};

const saveCow = () => {
  animals.push({
    id:Date.now(), role:"cow",
    sex:"Female",
    birth:cowBirth.value,
    tag:tag.value, color:color.value,
    vaccines:[], calves:[]
  });
  saveAll(); show("cows");
};

const saveBull = () => { bulls.push(bullNum.value); saveAll(); show("bulls"); };

const openAnimal = id => {
  current = animals.find(a=>a.id===id);
  detail.innerHTML = `
    <h2>${current.role.toUpperCase()}</h2>
    Tag: <input value="${current.tag||""}" oninput="current.tag=this.value"><br>
    Color: <input value="${current.color||""}" oninput="current.color=this.value"><br>
    Born: ${current.birth||"Unknown"}<br>
    Status: ${current.status||""}<br>
    <button class="primary small" onclick="promote()">Promote</button>
    <button class="danger small" onclick="remove()">Delete</button>
    <button class="secondary" onclick="show('${current.role}s')">Back</button>
  `;
  show("detail");
};

const promote = () => {
  if(current.role==="calf" && current.sex==="Female") current.role="heifer";
  else if(current.role==="heifer") current.role="cow";
  saveAll(); show(current.role+"s");
};

const remove = () => {
  animals = animals.filter(a=>a.id!==current.id);
  saveAll(); show("home");
};

const openBull = b => {
  detail.innerHTML = `<h2>ğŸ‚ Bull ${b}</h2><button class="secondary" onclick="show('bulls')">Back</button>`;
  show("detail");
};

show("home");
</script>

</body>
</html>