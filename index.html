<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cattle Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Arial;background:#f2f2f2;padding:15px}
h1{text-align:center}
button{width:100%;padding:14px;margin:6px 0;font-size:16px;border-radius:10px;border:none;color:#fff}
.primary{background:#2e7d32}
.secondary{background:#0277bd}
.warn{background:#ef6c00}
.danger{background:#c62828}
.card{background:#fff;padding:15px;border-radius:12px;margin-top:10px}
.hidden{display:none}
input,select{width:100%;padding:12px;margin:6px 0}
.list{cursor:pointer}
</style>
</head>

<body>

<h1>üêÑ Cattle Tracker</h1>

<div id="app">

<!-- HOME -->
<div id="home">
  <button class="primary" onclick="show('calves')">Calves</button>
  <button class="secondary" onclick="show('heifers')">Heifers</button>
  <button class="secondary" onclick="show('cows')">Cows</button>
  <button class="secondary" onclick="show('bulls')">Bulls</button>
</div>

<!-- CALVES -->
<div id="calves" class="hidden">
  <button class="primary" onclick="show('addCalf')">Add Calf</button>
  <div id="calfList"></div>
  <button class="secondary" onclick="show('home')">Back</button>
</div>

<!-- HEIFERS -->
<div id="heifers" class="hidden">
  <div id="heiferList"></div>
  <button class="secondary" onclick="show('home')">Back</button>
</div>

<!-- COWS -->
<div id="cows" class="hidden">
  <div id="cowList"></div>
  <button class="secondary" onclick="show('home')">Back</button>
</div>

<!-- BULLS -->
<div id="bulls" class="hidden">
  <button class="primary" onclick="show('addBull')">Add Bull</button>
  <div id="bullList"></div>
  <button class="secondary" onclick="show('home')">Back</button>
</div>

<!-- ADD CALF -->
<div id="addCalf" class="card hidden">
  <h3>Add Calf</h3>
  <select id="sex"><option>Female</option><option>Male</option></select>
  <input type="date" id="birth">
  <input placeholder="Dam tag" id="dam">
  <select id="sire"></select>
  <button class="primary" onclick="saveCalf()">Save</button>
  <button class="secondary" onclick="show('calves')">Cancel</button>
</div>

<!-- ADD BULL -->
<div id="addBull" class="card hidden">
  <h3>Add Bull</h3>
  <input id="bullNum" placeholder="Bull Number">
  <button class="primary" onclick="saveBull()">Save Bull</button>
  <button class="secondary" onclick="show('bulls')">Cancel</button>
</div>

<!-- DETAIL -->
<div id="detail" class="card hidden"></div>

</div>

<script>
let calves=JSON.parse(localStorage.calves||"[]");
let heifers=JSON.parse(localStorage.heifers||"[]");
let cows=JSON.parse(localStorage.cows||"[]");
let bulls=JSON.parse(localStorage.bulls||"[]");

let currentId=null,currentType=null;

function save(){
  localStorage.calves=JSON.stringify(calves);
  localStorage.heifers=JSON.stringify(heifers);
  localStorage.cows=JSON.stringify(cows);
  localStorage.bulls=JSON.stringify(bulls);
}

function show(id){
  document.querySelectorAll("#app > div").forEach(d=>d.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
  refresh();
}

function refresh(){
  calfList.innerHTML=calves.map(c=>`
    <div class="card list" onclick="openCalf(${c.id})">
      ${c.sex} calf | ${c.birth}
    </div>`).join("");

  heiferList.innerHTML=heifers.map(h=>`
    <div class="card list" onclick="openHeifer(${h.id})">
      Heifer | ${h.birth}
    </div>`).join("");

  cowList.innerHTML=cows.map(c=>`
    <div class="card list" onclick="openCow(${c.id})">
      Cow | Born ${c.birth}
    </div>`).join("");

  bullList.innerHTML=bulls.map(b=>`
    <div class="card list" onclick="openBull('${b}')">
      üêÇ Bull ${b}
    </div>`).join("");

  sire.innerHTML=bulls.map(b=>`<option>${b}</option>`).join("");
}

function saveBull(){
  if(!bullNum.value) return;
  bulls.push(bullNum.value);
  save();
  show('bulls');
}

function saveCalf(){
  calves.push({
    id:Date.now(),
    sex:sex.value,
    birth:birth.value,
    dam:dam.value,
    sire:sire.value
  });
  save();
  show('calves');
}

/* CALF */
function openCalf(id){
  currentId=id; currentType="calf";
  let c=calves.find(x=>x.id===id);
  detail.innerHTML=`
    <h3>Calf</h3>
    Sex <select id="eSex"><option>Female</option><option>Male</option></select>
    Birth <input type="date" id="eBirth" value="${c.birth}">
    Dam <input id="eDam" value="${c.dam}">
    Sire <input id="eSire" value="${c.sire}">
    <button class="primary" onclick="saveEdit()">Save</button>
    <button class="warn" onclick="promoteHeifer()">Promote to Heifer</button>
    <button class="secondary" onclick="show('calves')">Back</button>`;
  eSex.value=c.sex;
  show('detail');
}

function promoteHeifer(){
  let c=calves.find(x=>x.id===currentId);
  if(c.sex!=="Female"){alert("Only females can be promoted");return;}
  calves=calves.filter(x=>x.id!==currentId);
  heifers.push(c);
  save();
  show('heifers');
}

/* HEIFER */
function openHeifer(id){
  currentId=id; currentType="heifer";
  let h=heifers.find(x=>x.id===id);
  detail.innerHTML=`
    <h3>Heifer</h3>
    Birth <input type="date" id="eBirth" value="${h.birth}">
    Dam <input id="eDam" value="${h.dam}">
    Sire <input id="eSire" value="${h.sire}">
    <button class="primary" onclick="saveEdit()">Save</button>
    <button class="warn" onclick="promoteCow()">Promote to Cow</button>
    <button class="secondary" onclick="show('heifers')">Back</button>`;
  show('detail');
}

function promoteCow(){
  let h=heifers.find(x=>x.id===currentId);
  heifers=heifers.filter(x=>x.id!==currentId);
  cows.push(h);
  save();
  show('cows');
}

/* COW */
function openCow(id){
  let c=cows.find(x=>x.id===id);
  detail.innerHTML=`
    <h3>Cow</h3>
    Born: ${c.birth}<br>Dam: ${c.dam}<br>Sire: ${c.sire}
    <button class="secondary" onclick="show('cows')">Back</button>`;
  show('detail');
}

/* BULL */
function openBull(num){
  let sired=calves.filter(c=>c.sire===num);
  detail.innerHTML=`
    <h3>üêÇ Bull ${num}</h3>
    Calves Sired: ${sired.length}
    ${sired.map(c=>`<div>${c.sex} calf (${c.birth})</div>`).join("")}
    <button class="danger" onclick="deleteBull('${num}')">Delete Bull</button>
    <button class="secondary" onclick="show('bulls')">Back</button>`;
  show('detail');
}

function deleteBull(num){
  if(confirm("Delete bull?")){
    bulls=bulls.filter(b=>b!==num);
    save();
    show('bulls');
  }
}

function saveEdit(){
  let obj =
    currentType==="calf"?calves.find(x=>x.id===currentId):
    currentType==="heifer"?heifers.find(x=>x.id===currentId):
    cows.find(x=>x.id===currentId);

  if(eSex) obj.sex=eSex.value;
  obj.birth=eBirth.value;
  obj.dam=eDam.value;
  obj.sire=eSire.value;
  save();
  alert("Saved");
}

show('home');
</script>

</body>
</html>